---
title: "运算符与流程控制"
output: html_notebook
---


### 运算符
说到编程语言，你理解中它是干什么的？在我的眼里，程序就是为了处理数据而生的。我们把原始数据扔给编程语言，经过一通拳打脚踢的处理后，将数据整理好，然后生成人类容易观察的形式（比如生成一张图表，生成一个网页）来展示出来。

那这个处理的过程是什么样的呢？想想小学时候的数学公式，把一堆数字进行各种加减乘除运算，就有了答案啦。而这些加减乘除，就是我们今天要写的 **“运算符”**。

在R语言中，除了加减乘除，我们还会有其他的运算，大致可以分为下面这么几类，大致看一下有个印象就可以，毕竟随着时间的流逝，我们会对它们越来越熟悉的。

- 算术运算符
- 关系运算符
- 逻辑运算符
- 赋值运算符
- 其他运算符


#### 算术运算符

先来定义俩变量（我们通过`c()`函数来创建基本数据类型中的向量）
```{r}
var1 = c(2, 5.5, 6)
var2 = c(8, 3,   4)
```


运算符 | 描述 | 运算举例 | 运算结果
--- | --- | --- | ---
`+` | 两个向量相加| `print(var1 + var2)` | `10.0  8.5  10.0`
`-` | 两个向量相减| `print(var1 - var2)` | `-6.0  2.5  2.0`
`*` | 两个向量相乘| `print(var1 * var2)` | `16.0 16.5 24.0`
`/` | 两个向量相除| `print(var1 / var2)` | `0.250000 1.833333 1.500000`
`%%` |两个向量求余数 | `print(var1 %% var2)` | `2.0 2.5 2.0`
`%/%` | 两个向量相除求商 | `print(var1 %/% var2)` | ` 0 1 1` 
`^` | 将第二向量作为第一个向量的指数| `print(var1 ^ var2)` | `256.000  166.375 1296.000` 


#### 关系运算符

先来定义俩变量（我们通过`c()`函数来创建基本数据类型中的向量）
```{r}
var1 = c(2, 5.5,  6,  9)
var2 = c(8, 2.5,  14, 9)
```

运算符 | 描述 | 运算举例 | 运算结果
--- | --- | --- | ---
`>` | 检查第一个向量的每个元素是否大于第二个向量的每个元素| `print(var1 > var2)` | `FALSE  TRUE FALSE FALSE`
`<` | 检查第一个向量的每个元素是否小于第二个向量的每个元素| `print(var1 < var2)` | `TRUE FALSE  TRUE FALSE`
`>=` | 检查第一个向量的每个元素是否大于等于第二个向量的每个元素| `print(var1 >= var2)` | `FALSE  TRUE FALSE  TRUE`
`<=` | 检查第一个向量的每个元素是否小于等于第二个向量的每个元素| `print(var1 <= var2)` | `TRUE FALSE  TRUE  TRUE`
`==` |检查第一个向量的每个元素是否等于第二个向量的每个元素 | `print(var1 == var2)` | `FALSE FALSE FALSE  TRUE`
`!=` | 检查第一个向量的每个元素是否不等于第二个向量的每个元素 | `print(var1 != var2)` | `TRUE  TRUE  TRUE FALSE` 

#### 逻辑运算符
逻辑运算符看起来稍微复杂了一点，但是它的结果看起来却很简单， 因为答案只可能是TRUE或者FALSE。在R语言中，逻辑运算符分为两大类：

- 一类是参与运算的向量，内部的每个元素都进行比较，有 `&`、 `|`、`!`
- 另一类是参与运算的向量，只是看第一个元素，其余的不进行比较, 有`&&`、 `||`

下面分别看看它们都是怎么运算的吧。

##### `&`运算

也被称之为“元素逻辑AND运算符”，具体的运算规则为：
第一个向量的每个元素 与 第二个向量的每个元素进行组合，俩都为TRUE，结果为TRUE；俩只要有一个为FALSE，结果就是FALSE。
```{r}
v <- c(3,1,TRUE,2+3i)
t <- c(4,1,FALSE,2+3i)
print(v&t)
```

##### `|`运算

也被称之为“元素逻辑OR运算符”，具体的运算规则为：
第一个向量的每个元素 与 第二个向量的每个元素进行组合，俩都为FALSE，结果为FALSE；俩只要有一个为TRUE，结果就是TRUE。
```{r}
v <- c(3,1,TRUE,2+3i)
t <- c(4,1,FALSE,2+3i)
print(v|t)
```

##### `！`运算

也被称之为“元素逻辑非运算符”，具体的运算规则为：
对向量的每一个元素进行取反判断。人家本身为TRUE的，变成FALSE；人家本身为FALSE的，变成TRUE。
```{r}
v <- c(3,1,TRUE,2+3i, FALSE)
print(!v)
```


##### `&&`运算

也被称之为“元素逻辑逻辑AND运算符”，具体的运算规则为：
取两个向量的第一个元素进行比较，俩都为TRUE，结果为TRUE；俩只要有一个为FALSE，结果就是FALSE。
```{r}
v <- c(3,1,TRUE,2+3i)
t <- c(4,1,FALSE,2+3i)
print(v|t)
```


##### `||`运算

也被称之为“元素逻辑逻辑OR运算符”，具体的运算规则为：
取两个向量的第一个元素进行比较，俩都为FALSE，结果为FALSE；俩只要有一个为TRUE，结果就是TRUE。
```{r}
v <- c(3,0,TRUE,2+3i)
t <- c(4,0,FALSE,2+3i)
print(v|t)
```

#### 赋值运算符
赋值运算符在其他编程语言中，很可能只会有`=`符号来表示，在R语言中，就有很多变种，但是他们完成的功能是一样的。有`左分配` 和 `右分配`两种

##### 左分配
```{r}
v1 <- c(3,1,TRUE,2+3i)
v2 <<- c(3,1,TRUE,2+3i)
v3 = c(3,1,TRUE,2+3i)
print(v1)
print(v2)
print(v3)
```
可以看到，箭头是哪个方向，就叫什么分配，是不是很容易就记住了。

##### 右分配
```{r}
c(3,1,TRUE,2+3i) -> v1
c(3,1,TRUE,2+3i) ->> v2 
print(v1)
print(v2)
```

箭头往右，就叫右分配。

说完了左分配，右分配的，感觉很多样是吧。其实我们不用管那么多，只记住一个就好啦，那就是`=`。 随意一点，下次看到不一样的用法，知道有这么几个“分配”就好啦。


#### 其他运算符
这里要说的“其他运算符”可以说是R语言中特有的，就好比是“快捷键”一样，方便我们写代码用的。常见的有这仨 `:` `%in%` `%*%`, 下面分别来看看。

##### `:`冒号运算符
表示按顺序为向量创建一系列数字。
```{r}
variable = 2:8
print(variable)
```

##### `%in%`运算符
判断一个元素是否存在与一个向量中。
```{r}
variables = 2:8
target1 = 3
target2 = 9
print(target1 %in% variables)
print(target2 %in% variables)

```

##### `%*%` 运算符
该运算符应用于矩阵与其转置的乘积，比如：
```{r}
# 创建一个矩阵
m = matrix(c(1,2,3,4,5,6), nrow=2)
print(m)

# 获取矩阵的转置
tm = t(m)
print(tm)

# 求矩阵与矩阵转置的乘积
result = m %*% tm
print(result)
```



好不容易写完了，运算符好多啊，这些我都要学吗？答案是暂时不会也没关系，先混个脸熟，剩下的慢慢来，用着用着，就习惯啦。


### 流程控制

在开始“流程控制之前”，咱先来看看现实生活中需要你去做选择的例子。

- 案例1

“唐轩”这个病人在各种数据的筛选下，对其进行特征分析，手术是否有帮助的场景。

如果有帮助，那么就给他进行手术治疗；
如果帮助不大，那么就给他保守治疗方案，剩下的就听天由命吧。

- 案例2

明天要去香山玩，但是天气不知道是什么样。这个时候 **“明天的天气”** 就是一个不确定的因素，如果天气好，那我就不带雨伞；如果天气差，那我就带上雨伞。

诸如此类，我们每天都会面对很多选择。在编程语言的世界中，对数据的处理就是在这一个个的选择中进行的。这里我们有个比较“专业”的叫法，俗称“流程控制”。

看到这个词，不用先入为主，觉得它有多么高大上。其实它就是咱们生活中选择的缩影嘛。平时怎么做选择，在代码里也就怎么做选择。只不过是用写代码的形式而已。

#### if-else

![图示if-else](https://atts.w3cschool.cn/attachments/tuploads/r/r_decision_making.png)

---

咱就从字面意思上来看，`if-else`就是

```
如果 A条件成立
    我去做什么事
否则
    我去做另外的事
  
用代码翻译过来怎么写呢？
if (A == TRUE) {
    print("做A事")
}else {
    print("做B事")
}
```
好啦，到这里流程控制中的`if-else`就学会啦，是不是没你想象的那么难？对于`if-else`来说，这是它最简单的形式。我们还可以有其他的写法，比如下面的代码：

```{r}
# 给一个变量赋值为3
variable = 3

# 进行流程控制 判断
if(variable == 1) {
  print("1")
}else if(variable == 2) {
  print("2")
}else {
  print("3")
}
```

那你会想，如果我有好多个选择，那岂不是要写好多个的`else if(xxxxxx)`, 回答是：是的呢。

那有没有更简便的写法呢？答案是：有的哟。格式=如下：

```{r}
switch (object,
  case = action
)
```

咱们来举个例子：
```{r}
# 给一个变量赋值为字符串C
variable = "C"

# 多个判断条件的流程控制
switch (variable,
  "A" = print("1"),
  "B" = print("2"),
  "C" = print("3"),
  "D" = print("4")
)
```

如果感觉这个写法好奇怪，那咱就先不管它。等后面自己写`if-else`写烦了的时候，你自然就会想起来使用`switch`了。

#### 循环

![图示循环](https://atts.w3cschool.cn/attachments/tuploads/r/loop_architecture.jpg)


学习“循环”之前，我们先来了解下两个关键字 `break`、 `next`。 在其他的编程语言中，有的把`next`写作是`continue`,它俩语义是一致的，那就是：

> next 语句之后的代码都不执行，返回到循环判断的开头处，继续循环

而`break`在绝大多数的编程语言中都是一致的，意思是：

> 跳出循环体、终止循环


需要注意的是，不管是`break`还是 `next` 这俩关键字都只能出现在循环体的内部，不能用于其他地方。了解了它俩之后，我们就可以正式开启“循环”的学习啦。


---

在R语言中，循环的表述方式有三种，分别是`repeat`、 `while`、 `for`，平时看自己的个人喜好，选择其中一个就可以了，剩下的俩了解下写法即可。

##### repeat循环

```{r}
repeat { 
   commands 
   if(condition) {
      break
   }
}
```

比如我们要想打印十次“hello world.”， 我们就可以这么写：
```{r}
variable = 1
repeat {
  print("hello world.")
  variable = variable + 1;
  if (variable > 10) {
    break
  }
}
```

`commands`那一行，其实可以写好多行代码，把它当做是一个占位符就好。


##### while循环

While循环一次又一次地执行相同的代码，直到满足停止条件。

```{r}
while(condition) {
  commands
}
```

还是举上面的例子，打印十次“hello world.”,我们用while循环来写，它就是这个样子的。
```{r}
variable = 1
while(variable <= 10) {
  print("hello world.")
  variable = variable + 1
}
```

诶，是不是发现了什么不对的地方。repeat循环中我们写的是`if (variable > 10)` ，而在while循环中我们的判断条件是`while(variable <= 10)`。 为什么有的地方是大于号，而有的地方是小于等于呢？

答案其实也很简单，思考下：

> 10 大于 10 吗？


很明显10不大于10， 11才大于10。这样想是不是就很清晰了呢？😜

##### for循环
还有最后一个循环的表述方法，下面看看for循环要怎么写。

> For循环是一种重复控制结构，允许您有效地编写需要执行特定次数的循环。

```{r}
for (test_expression) {
   statement
}
```

哈哈哈，还是举那个例子，打印十次“hello world.”,用for循环就可以这么写：
```{r}
v# 创建一个长度为10的序列
ariables = 1:10
f# 遍历这个序列，因为人家有10个元素，所以这个判断会被循环执行10次，顺便打印了咱们需要的 “hello world.” 正好满足了要求。
or(item in variables) {
  print("hello world.")
}
```



就我而言，更习惯while循环的那种表述模式，对于其他两个，也算还行，但应该不怎么想用。但你也不用因此而纠结，选一个自己喜欢的模式就好啦😜。


