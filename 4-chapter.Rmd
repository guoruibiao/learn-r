---
title: "函数与包"
output: html_notebook
---

### 函数

程序员给你的第一印象是什么？

秃头？格子衫？不修边幅？拖鞋大裤衩？

我自己作为一个小码农，程序员给我的第一感觉就是“懒”。为什么这么说呢？因为写代码的时候，程序员是能少写就少写，能不写就不写。俗称：“大事化小，小事化了”😜。

说这个跟今天的主题“函数”有什么联系吗？当然啦，要不我也不会写它的对吧。

再来一个现实生活中的例子：医生给人看病，对相似的病症，总会有一个“模板”式的药方。然后再针对每个人的病症的不同之处，稍加修改。这里的“模板”在编程语言的世界中，就可以称之为“函数”，只需要写一次，就可以被后续多个地方使用。

是不是感觉很省事？这就是“偷懒”的一个很好的提现。正是因为这种“偷懒”，程序员设计出了很多经典的设计模式，让软件工程不再是垒积木一般，越来越臃肿，而是恰到好处的变得更加高效，更加方便。

扯了蛮多的了，下面开始进入正题，讲讲R语言中的“函数”。

#### 内置函数
从字面意思上来看，“内置”就是自带的，对不？是的，我们之前说过R语言是一个发动机，内置了很多东西，其中就有很多的函数。下面来举几个例子吧，后面可能还会遇到它们哦。


**paste()** 函数

```{r}
final_string = paste("hello", "world")
print(final_string)
```


**print()** 函数

这个函数我们已经见过很多次了，不陌生吧😜
```{r}
print("世间美好与你环环相扣")
cat("栢松")
```

**sum()** 函数
```{r}
summary = sum(1:10)
print(summary)
```

类似的内置函数还有很多，等你我去发现呢。




#### 自定义函数

自定义的意思就是程序员编写的函数，其结构格式为：

```{r}
function_name <- function(arg_1, arg_2, ...) {
   Function body 
   return xxx
}
```

可以看到这个框架包含了这么几个内容：

- `function_name` 就是个变量名，按照咱们之前学习的如何给变量取名，随便取一个符合规范的名字就好
- `function()` 这是个关键字，是固定的哦
- `arg1, arg2, arg3 ...` 函数参数，可以根据需求随便写好多个参数
- `Function body`  函数体，这个里面也可以随便写，只要是R语言的代码，写啥都行哦
- `return xxx` 返回值，其中 `return`是关键字，固定的哦，而`xxx`就是要返回的值，根据函数的作用不同，不同的函数返回的内容也不一定相同。另外，返回值也可以不写，就省略掉`return`语句就好。


规则不能扯太多，否则要看不下去了是不是？那咱来个例子，看看怎么写一个函数吧。


- 问问魔镜，这个世界上谁最漂亮？

```{r}
mirror_say <- function(name) {
  # paste() 这个函数是内置函数，意思是把两个字符串拼接成一个字符串
  print(paste(name, "最美啦"))
}

# 调用刚才写好的函数
mirror_say("小李医生")
```


- 如何治疗感冒？

```{r}
# 定义一个函数
the_cure <- function(name, temperature) {
  if( name == "唐轩") {
    print("唐轩患的不是感冒哦，请您换个药方")
  }else {
    if(temperature > 37) {
      print("有点发烧，请加点治疗发烧的药品")
    }else {
      print("给开盒感康吧，好像只是普通的感冒呢")
    }
  }
}

# 调用函数进行测试
the_cure("唐轩", 37)
the_cure("张三", 36.5)
the_cure("张三", 39)
```


关于函数，咱们再多聊几句。实际上的函数有很多形式

- 带参数的和不带参数的
- 带返回值的和不带返回值的

等等吧，我们平时也不需要过分关注这块，遇到了知道是怎么回事就好。


### 包

不知道你有没有听说过 **“包”治百病** 这个词，女朋友生气了，买个包，嘿，立马就不生气了。但是我们今天要讲的R语言里的“包”可不是LV包，酷奇包哦，而是一种组织规范。


> R语言的包是R函数，编译代码和样本数据的集合。 它们存储在R语言环境中名为“library”的目录下。 默认情况下，R语言在安装期间安装一组软件包。 随后添加更多包，当它们用于某些特定目的时。 当我们启动R语言控制台时，默认情况下只有默认包可用。 已经安装的其他软件包必须显式加载以供将要使用它们的R语言程序使用。




上面说到所有安装了的包都会放到一个叫library的目录中，那怎么找到这个路径呢？请看下面的代码：

```{r}
print(.libPaths())
```

在不同的机器上，输出的这个路径可能会不一样。不过没关系，有输出就可以啦。



有时候我们可能想看看，截止到现在为止，我到底安装过哪些包呢？可以借助下面的代码
```{r}
library()
```


获取当前的R环境中已经加载的包


```{r}
search()
```


安装别人的包，可以通过CRAN网页安装，也可以下载别人打包好的zip压缩文件进行安装（这个对新手来说比较复杂，咱先不看了）。

```{r}
install.packages("XML")
```


安装完之后，我们来查看一下，是否成功安装了`XML`的包。

```{r}
library()
```


可以看到，借助这个函数，我们就可以安装绝大部分我们需要的包了，如果想安装`json`的包，那么换成下面的代码即可。

```{r}
install.packages("json")
```

也就是说，我们也可以自己写很多包，然后发布到CRAN上，这样别人就可以下载和安装你写的包了。自己写的劳动成果被别人使用了，是不是很有成就感呢？
